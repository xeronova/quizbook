학생의 퀴즈 결과 데이터를 가져와서 `data/students/` 디렉토리에 저장하라.

## 입력 파라미터

- **$ARGUMENTS**: 학생 이름 또는 JSON 파일 경로
  - 이름만 제공: `data/students/<이름>.json` 또는 `<이름>_quizbook.json` 파일을 현재 디렉토리에서 탐색
  - 파일 경로 제공: 해당 경로의 JSON 파일을 사용
  - 생략 시: 사용자에게 물어본다

## 사전 조건

- `data/students/` 디렉토리가 존재해야 한다. 없으면 `/teacher-setup`을 먼저 실행하라고 안내한다.
- `data/roster.json`이 존재해야 한다. 없으면 `/teacher-setup`을 먼저 실행하라고 안내한다.

## 실행 절차

---

### 1단계: 파일 탐색 및 로드

$ARGUMENTS를 분석하여 가져올 JSON 파일을 찾는다:

- **파일 경로인 경우**: 해당 파일을 직접 읽는다
- **이름인 경우**: 아래 순서로 탐색한다
  1. `data/students/<이름>.json` (기존 데이터)
  2. `./<이름>_quizbook.json` (학생이 내보낸 파일, 프로젝트 루트)
  3. `~/Downloads/<이름>_quizbook.json` (다운로드 폴더)

```
🔍 파일 탐색: <탐색 경로>
  → 발견: <파일 경로>
```

**성공 조건**: JSON 파일을 찾아서 읽음
**실패 시**: "❌ 1단계 실패: <이름>에 해당하는 JSON 파일을 찾을 수 없음" 출력 후 중단

---

### 2단계: 데이터 유효성 검증

로드한 JSON이 `quizbook_data` v2 스키마와 호환되는지 검증한다:

**필수 필드 체크:**
- `version`: 숫자 (2 권장, 없으면 경고)
- `results`: 배열
  - 각 항목: `score`, `accuracy`, `correct`, `total`, `mode` 필드 존재 확인
- `stats`: 객체
  - `totalGames`, `totalCorrect`, `totalQuestions` 필드 존재 확인

**추가 필드 체크 (있으면 좋음):**
- `studentName`: 문자열 (파일에서 추출한 학생 이름)
- `exportedAt`: ISO 날짜 문자열

검증 결과를 표로 출력한다:

```
📋 데이터 검증 결과

| 항목             | 상태 | 값               |
|-----------------|------|-----------------|
| version         | ✅   | 2               |
| results 배열     | ✅   | 15개 기록        |
| stats           | ✅   | 15게임, 120정답  |
| studentName     | ✅   | 홍길동           |
| exportedAt      | ✅   | 2024-01-15      |
| 데이터 정합성     | ✅   | stats ↔ results 일치 |
```

**성공 조건**: 필수 필드가 모두 존재하고 올바른 타입
**실패 시**: "❌ 2단계 실패: 유효하지 않은 데이터 — <구체적 원인>" 출력 후 중단

---

### 3단계: 기존 데이터 확인 및 병합 처리

`data/students/<이름>.json`에 기존 데이터가 있는지 확인한다:

**기존 데이터가 없는 경우**: 바로 4단계로 진행

**기존 데이터가 있는 경우**: 병합 방식을 사용자에게 물어본다

- **덮어쓰기**: 새 데이터로 완전 교체
- **병합**: 기존 results에 새 results를 추가 (timestamp 기반 중복 제거)
- **취소**: 가져오기 중단

병합 시 처리 로직:
1. 기존 results와 새 results를 합친다
2. timestamp가 동일한 항목은 중복으로 판단하여 하나만 유지
3. timestamp 기준 내림차순 정렬
4. MAX_RESULTS (100개) 초과 시 오래된 것부터 제거
5. stats를 results 기반으로 재계산

```
📊 병합 결과
  기존 기록: N개
  새 기록: M개
  중복 제거: K개
  최종 기록: L개
```

**성공 조건**: 사용자가 처리 방식을 선택
**실패 시**: "❌ 3단계 실패: 사용자가 가져오기를 취소함" 출력 후 중단

---

### 4단계: 파일 저장 및 명부 업데이트

1. `data/students/<이름>.json`에 데이터를 저장한다
2. `data/roster.json`의 students 배열을 업데이트한다:
   - 새 학생이면 항목 추가
   - 기존 학생이면 `lastImport`와 `totalImports` 업데이트

```json
{
  "name": "<학생 이름>",
  "addedAt": "<최초 등록 ISO 날짜>",
  "lastImport": "<현재 ISO 날짜>",
  "totalImports": <누적 횟수>
}
```

`roster.json`의 `updated` 필드도 현재 시각으로 갱신한다.

**성공 조건**: 학생 파일과 명부가 업데이트됨
**실패 시**: "❌ 4단계 실패: 파일 저장 실패 — <구체적 원인>" 출력 후 중단

---

### 5단계: 가져오기 결과 보고

```
✅ 학생 데이터 가져오기 완료

👤 학생: <이름>
📁 저장 위치: data/students/<이름>.json
📊 데이터 요약:
  - 총 게임 수: N회
  - 총 정답 수: M개
  - 평균 점수: X점
  - 평균 정답률: Y%
  - 최고 점수: Z점
  - 최근 플레이: <날짜>

📋 명부 상태: 등록 학생 K명
```

---

## 오류 처리 정책

- 1~4단계 실패: 즉시 중단, 오류 보고, 파일 변경 없음
- JSON 파싱 실패: 파일 형식 오류 안내
- 사전 조건 미충족: `/teacher-setup` 실행 안내

## 주의사항

- 사용자 승인 없이 기존 학생 데이터를 덮어쓰지 마라 (3단계에서 확인).
- 가져온 데이터의 `settings` 필드는 무시한다 (개인 설정은 학생별로 다르므로).
- 파일 경로에 한글이 포함될 수 있으므로 인코딩에 주의한다.
